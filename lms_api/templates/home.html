{% extends "base.html" %}
{% block title %}Cursos - LMS{% endblock %}

{% block content %}

<h1 class="fw-bold text-center mb-4">Cursos disponibles</h1>

<div id="course-list" class="row g-4 px-2 mb-5">
    <p class="text-center text-muted">Cargando cursos...</p>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

    fetch("{% url 'ajax_list_courses' %}", {
        method: "GET",
        headers: {
            "X-Requested-With": "XMLHttpRequest"
        }
    })
    .then(res => res.json())
    .then(courses => {
        console.log("Cursos recibidos:", courses); 

        const container = document.getElementById("course-list");
        container.innerHTML = ""; 

        if (!courses.length) {
            container.innerHTML = `<p class="text-center text-muted">No hay cursos disponibles.</p>`;
            return;
        }

        courses.forEach(course => {
            const col = document.createElement("div");
            col.classList.add("col-md-4");

            col.innerHTML = `
            <div class="card card-custom h-100 p-3">

                <h5 class="fw-bold">${course.title}</h5>

                <p class="text-muted" style="font-size: 14px;">
                    ${(course.description || "").substring(0, 120)}...
                </p>

                <span class="badge bg-dark mb-2">${course.level}</span>
                <span class="badge bg-secondary mb-2">${course.language}</span>

                <a href="/courses/${course.id}/" class="btn btn-primary w-100 mt-3">
                    Ver curso
                </a>
            </div>
`;
            container.appendChild(col);
        });
    })
    .catch(err => console.error("Error AJAX:", err));

});
</script>

{% endblock %}
